<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador Gestión Cobranzas</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        /* --- ESTILOS GENERALES --- */
        :root {
            --header-bg: #1f4e5f;
            --bg-body: #ffffff;
            --color-tc-red: #c00000;
            --color-ppd-blue: #002060; /* Azul oscuro PPD */
            --color-ppd-purple: #542c5e; /* Morado PPD */
            --color-refi-purple: #7030a0;
            --color-yellow: #ffc000;
            --color-teal: #31869b;
            --color-teal-dark: #1f4e5f;
            --color-teal-light: #b7dee8;
            --color-purple-light: #e4dfec;
            
            /* Colores Speech */
            --sp-blue-dark: #0f243e;
            --sp-label-blue: #17375e;
            --sp-label-red: #963634;
            --sp-label-purple: #60497a;
            --sp-label-teal: #31859b;
            --sp-obl-border: #c00000;
            --sp-obl-bg: #fce4d6;
            --sp-obl-text: #c00000;
        }

        body { font-family: Arial, sans-serif; margin: 0; padding: 0; height: 100vh; display: flex; flex-direction: column; background-color: var(--bg-body); overflow: hidden; font-size: 12px; }
        
        /* HEADER */
        .top-header { background-color: var(--header-bg); color: white; padding: 15px; text-align: center; font-weight: bold; font-size: 16px; letter-spacing: 1px; flex-shrink: 0; }
        
        /* CONTENIDO PRINCIPAL */
        .main-viewport { flex: 1; overflow-y: auto; position: relative; background-color: #fff; padding: 20px; }
        .screen { display: none; width: 100%; height: 100%; }
        .screen.active { display: block; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* MENU PRINCIPAL */
        .menu-container { max-width: 900px; margin: 40px auto; display: flex; flex-direction: column; gap: 25px; }
        .menu-item { background-color: #f2f2f2; padding: 25px; display: flex; justify-content: space-between; align-items: center; border-radius: 4px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .menu-text { color: #1f4e5f; font-family: 'Courier New', monospace; font-weight: bold; font-size: 14px; text-transform: uppercase; }
        .btn-launch { padding: 10px 30px; color: white; border: none; border-radius: 4px; font-weight: bold; cursor: pointer; font-size: 12px; box-shadow: 0 2px 4px rgba(0,0,0,0.2); }

        /* PESTAÑAS INFERIORES */
        .bottom-tabs { background-color: #f0f0f0; border-top: 1px solid #ccc; height: 30px; display: flex; align-items: flex-end; padding-left: 5px; flex-shrink: 0; }
        .tab-btn { padding: 5px 15px; margin-right: 2px; background-color: #e6e6e6; border: 1px solid #ccc; border-bottom: none; cursor: pointer; font-size: 11px; font-weight: bold; color: #333; border-radius: 4px 4px 0 0; display: none; }
        .tab-btn.visible { display: block; }
        .tab-btn.active { background-color: #fff; padding-bottom: 7px; margin-top: -2px; z-index: 10; border-top: 3px solid; }
        
        /* Colores activos tabs */
        .t-menu.active { border-top-color: #008000; }
        .t-calc.active { border-top-color: var(--color-yellow); background-color: var(--color-yellow); }
        .t-red.active { border-top-color: var(--color-tc-red); background-color: var(--color-tc-red); color: white; }
        .t-blue.active { border-top-color: var(--color-ppd-blue); background-color: var(--color-ppd-blue); color: white; }
        .t-yellow.active { border-top-color: var(--color-yellow); background-color: var(--color-yellow); }

        /* --- ESTILOS PESTAÑA CALCULADOR --- */
        .calc-title { background-color: var(--color-teal-dark); color: white; padding: 8px; font-weight: bold; text-align: center; text-transform: uppercase; font-size: 14px; margin-bottom: 15px; }
        .consideraciones { margin-bottom: 20px; color: #333; }
        
        .tc-row { display: flex; align-items: center; margin-bottom: 20px; }
        .tc-label { background-color: var(--color-teal-dark); color: white; padding: 5px 15px; font-weight: bold; width: 150px; }
        .tc-input { width: 100px; padding: 5px; text-align: center; font-weight: bold; border: 1px solid #ccc; margin-left: 10px; }
        
        .calc-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; }
        
        .calc-table { width: 100%; border-collapse: collapse; margin-bottom: 0; }
        .calc-table th { padding: 6px; font-size: 11px; border: 1px solid #ddd; }
        .calc-table td { padding: 6px; font-size: 11px; border: 1px solid #ddd; height: 22px; }
        .calc-table input { width: 100%; border: none; text-align: right; background: transparent; outline: none; font-size: 11px; }
        
        .header-repro { background-color: var(--color-teal-dark); color: white; padding: 5px; font-weight: bold; text-align: center; text-transform: uppercase; }
        .th-repro { background-color: var(--color-teal-light); color: black; }
        .header-refi { background-color: var(--color-refi-purple); color: white; padding: 5px; font-weight: bold; text-align: center; text-transform: uppercase; }
        .th-refi { background-color: var(--color-purple-light); color: black; }
        .bg-pink { background-color: #fce4d6; }
        
        .totals-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        .totals-table td { padding: 6px; border: 1px solid #ddd; font-size: 11px; }
        .row-consolidado td { background-color: var(--color-teal-dark); color: white; font-weight: bold; }
        .row-consolidado-refi td { background-color: var(--color-refi-purple); color: white; font-weight: bold; }
        .row-detail td { background-color: white; color: black; }

        /* ESTILOS PESTAÑAS SIMULADORES (TC y PPD) */
        .tc-container-header { border-bottom: 3px solid #000; margin-bottom: 10px; text-align: center; font-weight: bold; font-size: 14px; padding-bottom: 5px; }
        .tc-top-panel { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 10px; }
        .tc-field-row { display: flex; align-items: center; margin-bottom: 4px; }
        .tc-lbl { width: 40px; text-align: right; font-weight: bold; margin-right: 5px; font-size: 11px; }
        .tc-inp-blue { background-color: #0070c0; color: white; border: none; text-align: center; font-weight: bold; width: 60px; padding: 3px; }
        .tc-inp-white { border: none; text-align: center; width: 60px; padding: 3px; background: transparent; }
        .tc-center-display { display: flex; align-items: center; gap: 5px; }
        .tc-saldo-box { background-color: #0070c0; color: white; padding: 5px 10px; font-weight: bold; min-width: 60px; text-align: center; }
        .tc-inp-cyan { background-color: #00b0f0; color: white; border: none; text-align: center; font-weight: bold; width: 80px; padding: 3px; }
        
        /* Grid headers para PPD */
        .grid-header-3col { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; background: #eef5f7; padding: 10px; border: 1px solid #ccc; margin-bottom: 10px; }
        .field-block { display: flex; align-items: center; gap: 5px; margin-bottom: 3px; }
        .field-lbl { font-weight: bold; width: 110px; text-align: right; font-size: 11px; }
        .inp-white-border { border: 1px solid #ccc; width: 100px; padding: 2px; text-align: center; }
        
        /* Tablas Cronograma */
        .crono-table { width: 100%; border-collapse: collapse; font-size: 11px; margin-top: 5px; }
        .crono-table th { color: white; border: 1px solid #000; padding: 3px; text-align: center; }
        .crono-table td { border: 1px solid #000; padding: 3px; text-align: center; }
        
        /* Header Colors */
        .bg-blue { background-color: #0070c0; }
        .bg-purple { background-color: var(--color-ppd-purple); }
        .bg-header-purple { background-color: #9275a5; }

        /* ESTILOS SPEECH */
        .sp-top-bar { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 20px; }
        .sp-input-group { display: flex; flex-direction: column; gap: 5px; }
        .sp-row { display: flex; gap: 15px; }
        .sp-lbl-dark { background-color: var(--sp-blue-dark); color: white; padding: 4px 8px; font-weight: bold; width: 110px; font-size: 11px; display: flex; align-items: center; }
        .sp-inp { background: #f2f2f2; border: 1px solid #ccc; padding: 4px; width: 180px; }
        .sp-inp-short { background: #fff; border: 1px solid #ccc; padding: 4px; width: 100px; text-align: center; }
        .btn-action { background: #e0e0e0; border: 1px solid #999; padding: 6px 30px; font-weight: bold; cursor: pointer; text-transform: uppercase; font-size: 11px; }
        
        .sp-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
        .sp-grid-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-bottom: 20px; } /* 3 Cols para PPD */
        
        .sp-header { color: white; font-weight: bold; text-align: center; padding: 6px; margin-bottom: 10px; }
        .sp-h-blue { background-color: var(--sp-blue-dark); }
        .sp-h-purple { background-color: var(--sp-label-purple); }
        .sp-h-teal { background-color: var(--sp-label-teal); }
        
        .sp-data-row { display: flex; margin-bottom: 4px; }
        .sp-data-lbl { color: white; padding: 4px 8px; font-weight: bold; width: 100px; font-size: 10px; display: flex; align-items: center; }
        .sp-data-inp { flex: 1; border: none; background: #f9f9f9; padding: 4px; font-size: 11px; margin-left: 2px; width: 100%; box-sizing: border-box; }
        
        .lbl-blue { background-color: var(--sp-label-blue); }
        .lbl-red { background-color: var(--sp-label-red); }
        .lbl-purple { background-color: var(--sp-label-purple); }
        .lbl-teal { background-color: var(--sp-label-teal); }
        .lbl-yellow { background-color: var(--color-yellow); color: black; text-align: center; justify-content: center; }
        .sp-lock { float: right; color: #999; margin-top: 2px; font-size: 10px; }

        /* Bloques Speech */
        .speech-section { display: flex; border: 1px solid #ccc; margin-bottom: 10px; background: #fff; }
        .speech-title-box { background-color: #f2f2f2; width: 120px; display: flex; align-items: center; justify-content: center; font-weight: bold; border-right: 1px solid #ccc; font-size: 11px; text-align: center; padding: 5px; }
        
        .speech-section-obl { display: flex; border: 1px solid var(--sp-obl-border); margin-bottom: 10px; background: #fff; }
        .speech-title-box-obl { background-color: var(--sp-obl-bg); color: var(--sp-obl-text); width: 120px; display: flex; flex-direction: column; align-items: center; justify-content: center; font-weight: bold; border-right: 1px solid var(--sp-obl-border); font-size: 11px; text-align: center; padding: 5px; }

        .speech-content-box { padding: 15px; flex: 1; font-size: 11px; line-height: 1.5; color: #333; }
        .yellow-bar { background-color: #ffff00; padding: 4px; font-weight: bold; margin-bottom: 10px; border: 1px solid #ddd; }
        .hl { color: #00b0f0; font-weight: bold; }
        .note-box { background-color: #eaf6fc; padding: 5px; margin-top: 10px; border-left: 3px solid #00b0f0; color: #0070c0; }
        
        .capture-form { display: grid; grid-template-columns: auto 1fr; gap: 10px; max-width: 600px; margin-top: 10px; }
        .capture-lbl { font-weight: bold; align-self: center; }
        .capture-inp { padding: 4px; border: 1px solid #ccc; background: #f2f2f2; width: 100%; box-sizing: border-box; }
        .btn-update { background-color: #e0e0e0; border: 1px solid #999; padding: 5px 20px; cursor: pointer; font-weight: bold; justify-self: start; margin-top: 5px; }

    </style>
</head>
<body>

    <div class="top-header">SIMULADORES DE GESTIÓN – COBRANZAS</div>

    <div class="main-viewport">
        <div id="screen-Menu" class="screen active">
            <div class="menu-container">
                <div class="menu-item" style="border: 2px solid var(--color-ppd-blue);"><div class="menu-text">REPROGRAMACIÓN A PRÉSTAMO PERSONAL INDEPENDIENTE</div><button class="btn-launch" style="background-color: var(--color-ppd-blue);" onclick="iniciarSimulador('PPD')">IR A SIMULADOR</button></div>
                <div class="menu-item" style="border: 2px solid var(--color-tc-red);"><div class="menu-text">REPROGRAMACIÓN (SOLO TC)</div><button class="btn-launch" style="background-color: var(--color-tc-red);" onclick="iniciarSimulador('TC')">IR A SIMULADOR</button></div>
                <div class="menu-item"><div class="menu-text">REFINANCIAMIENTO A PRÉSTAMO DE LIBRE DISPOSICIÓN</div><button class="btn-launch" style="background-color: #999;">IR A SIMULADOR</button></div>
            </div>
        </div>

        <div id="screen-Calculador" class="screen">
            <div class="calc-title">CALCULAR - MONTO A REPROGRAMAR | REFINANCIAR</div>
            <div class="consideraciones"><strong>Consideraciones:</strong><ul><li>Modificar (diario) el tipo de cambio...</li><li>Tras ingresar los datos de saldo...</li></ul></div>
            <div class="tc-row"><div class="tc-label">TIPO DE CAMBIO:</div><input type="number" id="tc_input" value="3.7000" class="tc-input" oninput="calcularTab1()"></div>
            <div class="calc-grid">
                <div>
                    <div class="header-repro">REPROGRAMACIÓN</div>
                    <table class="calc-table">
                        <thead><tr><th class="th-repro">PRODUCTO</th><th class="th-repro">MONTO</th><th class="th-repro">TOTAL SOLES</th></tr></thead>
                        <tbody>
                            <tr><td>SALDO TC SOLES</td><td><input type="number" id="in_repro_sol" placeholder="0.00" oninput="calcularTab1()"></td><td><input type="text" id="out_repro_sol" readonly></td></tr>
                            <tr><td>SALDO TC DÓLARES</td><td><input type="number" id="in_repro_dol" placeholder="0.00" oninput="calcularTab1()"></td><td><input type="text" id="out_repro_dol" readonly></td></tr>
                            <tr><td colspan="3" style="height:15px; border:none;"></td></tr>
                            <tr><td>Saldo Total Cuota (PPD)</td><td class="bg-pink"></td><td><input type="text" value="S/ -" readonly></td></tr>
                            <tr><td>Saldo Total Capital (PPD)</td><td class="bg-pink"></td><td><input type="text" value="S/ -" readonly></td></tr>
                            <tr><td>Interés Acumulado (PPD)</td><td class="bg-pink"></td><td><input type="text" value="S/ -" readonly></td></tr>
                        </tbody>
                    </table>
                    <table class="totals-table">
                        <tr class="row-consolidado"><td width="50%">SALDO REPRO CONSOLIDADO</td><td width="20%">S/</td><td style="text-align:right;"><span id="total_repro_cons">0.00</span></td></tr>
                        <tr class="row-detail"><td>TOTAL TARJETA</td><td>S/</td><td style="text-align:right;"><span id="total_tarjeta">0.00</span></td></tr>
                        <tr class="row-detail"><td>TOTAL PRÉSTAMO</td><td>S/</td><td style="text-align:right;">-</td></tr>
                    </table>
                </div>
                <div>
                    <div class="header-refi">REFINANCIAMIENTO</div>
                    <table class="calc-table"><thead><tr><th class="th-refi">PRODUCTO</th><th class="th-refi">MONTO</th><th class="th-refi">TOTAL SOLES</th></tr></thead><tbody><tr><td>SALDO TC SOLES</td><td class="bg-pink"></td><td>S/ -</td></tr></tbody></table>
                    <table class="totals-table"><tr class="row-consolidado-refi"><td>SALDO REFI CONSOLIDADO</td><td>S/</td><td style="text-align:right;">-</td></tr></table>
                </div>
            </div>
        </div>

        <div id="screen-Calculo_TC" class="screen">
            <div class="tc-container-header">Tarjeta de Crédito</div>
            <div class="tc-top-panel">
                <div style="width: 150px;">
                    <div class="tc-field-row"><div class="tc-lbl">TEA:</div><input type="number" id="tc_tea" value="33.99" class="tc-inp-blue" oninput="calcularCronograma()"> %</div>
                    <div class="tc-field-row"><div class="tc-lbl">TEM:</div><input type="text" id="tc_tem" readonly class="tc-inp-white"> %</div>
                    <div class="tc-field-row"><div class="tc-lbl">TCEA:</div><input type="text" value="34.35" readonly class="tc-inp-white"> %</div>
                    <div style="height: 10px;"></div>
                    <div class="tc-field-row"><div class="tc-lbl">Plazo:</div><input type="number" id="tc_plazo" value="16" class="tc-inp-blue" oninput="calcularCronograma()"></div>
                </div>
                <div class="tc-center-display"><span style="font-weight: bold;">Saldo a la fecha (S/)</span><div id="tc_saldo_crm" class="tc-saldo-box">0</div><span style="font-weight: bold;"><- (CRM)</span></div>
                <div class="tc-right-col">
                    <div style="margin-bottom: 5px;"><label>Fecha Solicitud</label><input type="date" id="tc_fec_sol" class="tc-inp-cyan" style="width: 100px;" onchange="calcularCronograma()"></div>
                    <div><label>Ciclo (TC)</label><input type="number" value="18" class="tc-inp-cyan"></div>
                </div>
            </div>
            <div class="crono-header-bar">CRONOGRAMA</div>
            <table class="crono-table"><thead><tr><th>Mes</th><th>EECC</th><th>Vencim.</th><th>Días</th><th>Saldo inicial</th><th>Amortización</th><th>Interés</th><th>Cuota</th></tr></thead><tbody id="tc_tabla_body"></tbody></table>
        </div>

        <div id="screen-Speech_TC" class="screen">
            <div class="sp-top-bar">
                <div class="sp-input-group">
                    <div class="sp-row"><div style="display:flex"><div class="sp-lbl-dark">Nombre Socio: *</div><input type="text" id="sp_nombre" class="sp-inp" oninput="actualizarValidacion('TC')"></div></div>
                    <div style="margin-top: 5px;" class="sp-row"><div style="display:flex"><div class="sp-lbl-dark">Nombre Ejecutivo: *</div><input type="text" id="sp_ejecutivo" class="sp-inp"></div></div>
                    <div style="margin-top: 5px;" class="sp-row">
                         <div style="display:flex"><div class="sp-lbl-dark">DNI Socio: *</div><input type="text" id="sp_dni" class="sp-inp-short" oninput="actualizarValidacion('TC')"></div>
                    </div>
                </div>
                <div style="display: flex; gap: 20px;"><button class="btn-action" onclick="generarSpeechTC()">APLICAR</button><button class="btn-action" style="background:#fff;" onclick="limpiarSpeech()">LIMPIAR</button></div>
            </div>
            <div class="sp-grid">
                <div>
                    <div class="sp-panel-header-diners">INFORMACIÓN TARJETA DINERS</div>
                    <div style="display: flex; gap: 10px;">
                        <div style="flex: 1;">
                            <div class="sp-data-row"><div class="sp-data-lbl lbl-blue">Pago Mes (S/):</div><input id="sp_mes_s" class="sp-data-inp"></div>
                            <div class="sp-data-row"><div class="sp-data-lbl lbl-red">Pago Mínimo (S/):</div><input id="sp_min_s" class="sp-data-inp"></div>
                            <div class="sp-data-row"><div class="sp-data-lbl lbl-blue">Venc. EECC: *</div><input type="date" id="sp_venc" class="sp-data-inp"></div>
                            <div class="sp-data-row"><div class="sp-data-lbl lbl-blue">Días Mora: *</div><input type="number" id="sp_mora" class="sp-data-inp"></div>
                        </div>
                        <div style="flex: 1;">
                            <div class="sp-data-row"><div class="sp-data-lbl lbl-blue">Pago Inicial TC (S/):</div><input id="sp_ini_s" class="sp-data-inp"></div>
                            <div class="sp-data-row"><div class="sp-data-lbl lbl-purple">Deuda Total (S/):</div><input id="sp_total_s" class="sp-data-inp"></div>
                        </div>
                    </div>
                </div>
                <div>
                    <div class="sp-panel-header-repro">INFORMACIÓN REPROGRAMACIÓN</div>
                    <div style="display: flex; gap: 10px;">
                        <div style="flex: 1;">
                            <div class="sp-data-row"><div class="sp-data-lbl lbl-teal">Monto a Financiar</div><input id="sp_monto" readonly class="sp-data-inp"><i class="fas fa-lock sp-lock"></i></div>
                            <div class="sp-data-row"><div class="sp-data-lbl lbl-teal">TEA</div><input id="sp_tea" readonly class="sp-data-inp"><i class="fas fa-lock sp-lock"></i></div>
                            <div class="sp-data-row"><div class="sp-data-lbl lbl-teal">1er Fecha Venc.</div><input id="sp_fvenc" readonly class="sp-data-inp"><i class="fas fa-lock sp-lock"></i></div>
                        </div>
                        <div style="flex: 1;">
                            <div class="sp-data-row"><div class="sp-data-lbl lbl-teal">Num Cuotas</div><input id="sp_cuotas" readonly class="sp-data-inp"><i class="fas fa-lock sp-lock"></i></div>
                            <div class="sp-data-row"><div class="sp-data-lbl lbl-teal">Cuota PPD</div><input id="sp_cuota_ppd" readonly class="sp-data-inp"><i class="fas fa-lock sp-lock"></i></div>
                            <div style="height: 50px;"></div>
                            <div class="sp-data-row"><div class="sp-data-lbl lbl-yellow" style="width:100%">Tipo de Campaña: *</div></div>
                             <select id="sp_campana" style="width:100%; padding:4px;"><option>-- Seleccione --</option><option>Cambio de Plan</option><option>Socios para siempre</option></select>
                        </div>
                    </div>
                </div>
            </div>
            <div class="speech-section"><div class="speech-title-box">SALUDO</div><div class="speech-content-box" id="txt_saludo">...</div></div>
            <div class="speech-section"><div class="speech-title-box">COBRAR</div><div class="speech-content-box" id="txt_cobrar">...</div></div>
            <div class="speech-section-obl"><div class="speech-title-box-obl">CAMPAÑA<br>(OBLIGATORIO)</div><div class="speech-content-box"><div class="yellow-bar">PRIMERA LLAMADA</div><p>En Diners Club... abono inicial de <span class="hl" id="camp_abono_s">S/ 0.00</span>...</p></div></div>
            <div class="speech-section-obl"><div class="speech-title-box-obl">VALIDACION<br>(OBLIGATORIO)</div><div class="speech-content-box"><ul><li>Nombre: <span class="hl" id="val_nombre">---</span></li><li>DNI: <span class="hl" id="val_dni">---</span></li></ul></div></div>
            <div class="speech-section-obl"><div class="speech-title-box-obl">RESUMEN<br>(OBLIGATORIO)</div><div class="speech-content-box" id="txt_resumen">...</div></div>
        </div>

        <div id="screen-Calculo_Seguro" class="screen">
            <div style="text-align:center; font-weight:bold; font-size:14px; margin-bottom:10px;">Préstamo Personal Diners / Préstamo Personal Diners Plus</div>
            <div class="grid-header-3col" style="background:#e6e6e6;">
                <div style="grid-column: span 2;">
                    <div class="field-block"><span class="field-lbl">Fecha desembolso:</span><input type="date" id="ppd_fec_des" class="inp-white-border" onchange="calcSeguroPPD()"></div>
                    <div class="field-block"><span class="field-lbl">Importe Solicitado:</span><input type="number" id="ppd_importe_sol" class="inp-white-border" readonly></div>
                    <div class="field-block"><span class="field-lbl">Seguro Desg.:</span><input type="text" value="0.79%" class="inp-white-border" disabled></div>
                </div>
                <div>
                    <div class="field-block"><span class="field-lbl">Plazo Seguro:</span><input type="number" value="24" class="inp-white-border" disabled></div>
                    <div style="background:#0070c0; color:white; padding:5px; font-weight:bold; margin:5px 0;">Costo del Seguro (S/): <span id="ppd_costo_seguro">0.00</span></div>
                    <div style="background:#0070c0; color:white; padding:5px; font-weight:bold;">Importe a financiar: <span id="ppd_importe_fin">0.00</span></div>
                </div>
            </div>
            <div style="background:var(--color-ppd-purple); color:white; font-weight:bold; text-align:center; padding:5px;">CRONOGRAMA SEGURO DESGRAVAMEN PPD</div>
            <table class="crono-table"><thead><tr><th style="background:#9275a5">Mes</th><th style="background:#9275a5">Vencim.</th><th style="background:#9275a5">Saldo Inicial</th><th style="background:#9275a5">Cuota</th></tr></thead><tbody id="ppd_tabla_seguro"></tbody></table>
        </div>

        <div id="screen-Calculo_PPD" class="screen">
            <div style="text-align:center; font-weight:bold; font-size:14px; margin-bottom:10px;">Préstamo Personal Diners</div>
            <div class="grid-header-3col">
                <div>
                    <div class="field-block"><span class="field-lbl">Importe Solic.:</span><input type="text" id="ppd_c_sol" readonly class="inp-white-border"></div>
                    <div class="field-block"><span class="field-lbl">TEA:</span><input type="number" id="ppd_tea" value="17.04" class="inp-white-border" oninput="calcPPD()"></div>
                    <div class="field-block"><span class="field-lbl">Plazo:</span><input type="number" id="ppd_plazo" value="48" class="inp-white-border" oninput="calcPPD()"></div>
                </div>
                <div>
                    <div class="field-block"><span class="field-lbl">Seguro:</span><input type="text" value="0.79%" readonly class="inp-white-border"></div>
                    <div style="background:#0070c0; color:white; padding:5px; margin-bottom:5px;">Monto a abonar: <span id="ppd_abonar">0.00</span></div>
                    <div style="background:#0070c0; color:white; padding:5px;">Importe a financiar: <span id="ppd_financiar">0.00</span></div>
                </div>
                <div>
                    <div class="field-block"><span class="field-lbl">1er Vencim:</span><input type="date" id="ppd_1er_venc" class="inp-white-border"></div>
                    <div class="field-block"><span class="field-lbl">Cuota:</span><input type="text" id="ppd_cuota_res" readonly class="tc-inp-blue"></div>
                </div>
            </div>
            <div style="background:#0070c0; color:white; font-weight:bold; text-align:center; padding:5px;">CRONOGRAMA</div>
            <table class="crono-table"><thead><tr><th class="bg-blue">Mes</th><th style="background:#ffff00; color:black">Vencim.</th><th class="bg-blue">Saldo</th><th class="bg-blue">Cuota</th></tr></thead><tbody id="ppd_tabla_crono"></tbody></table>
        </div>

        <div id="screen-Speech_PPD" class="screen">
            <div class="sp-top-bar">
                <div style="display:flex; gap:10px;"><div class="sp-lbl lbl-c-blue">Nombre Socio: *</div><input type="text" id="sp_ppd_nombre" oninput="actualizarValidacion('PPD')"></div>
                <button class="btn-action" onclick="generarSpeechPPD()">APLICAR</button>
            </div>
            <div class="sp-grid-3">
                <div><div class="sp-header sp-h-blue">TARJETA DINERS</div><div class="sp-row-data"><div class="sp-lbl lbl-blue">Pago Mes:</div><input class="sp-data-inp"></div></div>
                <div><div class="sp-header sp-h-purple">INFORMACIÓN PPD/PPI</div><div class="sp-row-data"><div class="sp-lbl lbl-purple">Pago Mes:</div><input class="sp-data-inp"></div></div>
                <div>
                    <div class="sp-header sp-h-teal">INFORMACIÓN REPROGRAMACIÓN</div>
                    <div class="sp-row-data"><div class="sp-lbl lbl-teal">Monto Fin:</div><input id="sp_ppd_monto" readonly class="sp-data-inp"><i class="fas fa-lock sp-lock"></i></div>
                    <div class="sp-row-data"><div class="sp-lbl lbl-teal">Monto Seg:</div><input id="sp_ppd_seguro_val" readonly class="sp-data-inp"><i class="fas fa-lock sp-lock"></i></div>
                    <div class="sp-row-data"><div class="sp-lbl lbl-teal">Cuota PPD:</div><input id="sp_ppd_cuota" readonly class="sp-data-inp"><i class="fas fa-lock sp-lock"></i></div>
                    <div class="sp-row-data"><div class="sp-lbl lbl-yellow">Campaña:</div><select class="sp-data-inp"><option>PPD</option></select></div>
                </div>
            </div>
            
            <div class="speech-section-obl"><div class="speech-title-box-obl">CAMPAÑA<br>(OBLIGATORIO)</div><div class="speech-content-box"><div class="yellow-bar">PRIMERA LLAMADA</div><p>Para que este beneficio sea aplicado, usted tiene que realizar un abono inicial...</p></div></div>
            <div class="speech-section-obl"><div class="speech-title-box-obl">OFERTA SEGURO</div><div class="speech-content-box"><p>Contamos con los siguientes seguros... <b>Seguro de Desgravamen Saldo</b>...</p></div></div>
            <div class="speech-section-obl"><div class="speech-title-box-obl">RESUMEN<br>(OBLIGATORIO)</div><div class="speech-content-box" id="txt_ppd_resumen"><p style="color:red; font-weight:bold;">Obligatorio mencionar el importe del seguro que será cargado...</p><p>Monto total a financiar: <span class="hl" id="res_ppd_monto">---</span>. Desembolso deuda: <span class="hl" id="res_ppd_abonar">---</span>. Costo Seguro: <span class="hl" id="res_ppd_costo_seg">---</span>.</p><p>Valor cuota: <span class="hl" id="res_ppd_cuota_val">---</span>.</p></div></div>
        </div>

        <div id="screen-Detallador" class="screen"><h2 style="text-align: center; margin-top: 50px;">En Construcción</h2></div>
    </div>

    <div class="bottom-tabs">
        <div class="tab-btn t-menu visible active" id="btn-Menu" onclick="irAMenu()">Menu</div>
        <div class="tab-btn t-calc" id="btn-Calculador" onclick="mostrarPantalla('Calculador')">Calculador</div>
        <div class="tab-btn t-red" id="btn-Calculo_TC" onclick="mostrarPantalla('Calculo_TC')">Calculo_TC</div>
        <div class="tab-btn t-red" id="btn-Speech_TC" onclick="mostrarPantalla('Speech_TC')">Speech_TC</div>
        <div class="tab-btn t-blue" id="btn-Calculo_Seguro" onclick="mostrarPantalla('Calculo_Seguro')">Calculo_Seguro</div>
        <div class="tab-btn t-blue" id="btn-Calculo_PPD" onclick="mostrarPantalla('Calculo_PPD')">Calculo_PPD</div>
        <div class="tab-btn t-blue" id="btn-Speech_PPD" onclick="mostrarPantalla('Speech_PPD')">Speech_PPD</div>
        <div class="tab-btn t-yellow" id="btn-Detallador" onclick="mostrarPantalla('Detallador')">Detallador</div>
    </div>

<script>
    let appData = { total: 0, tc_cuota: 0, ppd_seguro: 0, ppd_total: 0, ppd_cuota: 0 };
    document.getElementById('tc_fec_sol').valueAsDate = new Date();
    document.getElementById('ppd_fec_des').valueAsDate = new Date();

    function irAMenu() { document.querySelectorAll('.tab-btn').forEach(b => { if(b.id!=='btn-Menu') b.classList.remove('visible'); }); mostrarPantalla('Menu'); }
    function iniciarSimulador(tipo) {
        document.querySelectorAll('.tab-btn').forEach(b => { if(b.id!=='btn-Menu') b.classList.remove('visible'); });
        document.getElementById('btn-Calculador').classList.add('visible'); document.getElementById('btn-Detallador').classList.add('visible');
        if(tipo === 'TC') { document.getElementById('btn-Calculo_TC').classList.add('visible'); document.getElementById('btn-Speech_TC').classList.add('visible'); }
        if(tipo === 'PPD') { document.getElementById('btn-Calculo_Seguro').classList.add('visible'); document.getElementById('btn-Calculo_PPD').classList.add('visible'); document.getElementById('btn-Speech_PPD').classList.add('visible'); }
        mostrarPantalla('Calculador');
    }
    function mostrarPantalla(nombre) { document.querySelectorAll('.screen').forEach(s => s.classList.remove('active')); document.getElementById('screen-'+nombre).classList.add('active'); document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active')); const btn = document.getElementById('btn-'+nombre); if(btn) btn.classList.add('active'); sincronizar(); }

    function calcularTab1() {
        let s = parseFloat(document.getElementById('in_repro_sol').value)||0, d = parseFloat(document.getElementById('in_repro_dol').value)||0, tc = parseFloat(document.getElementById('tc_input').value)||3.7;
        let total = s + (d*tc);
        document.getElementById('out_repro_sol').value = "S/ " + s.toFixed(2); document.getElementById('out_repro_dol').value = "S/ " + (d*tc).toFixed(2);
        document.getElementById('total_repro_cons').innerText = total.toFixed(2); document.getElementById('total_tarjeta').innerText = total.toFixed(2);
        appData.total = total;
    }

    function calcularCronograma() {
        let P=appData.total, tea=parseFloat(document.getElementById('tc_tea').value)||0, n=parseInt(document.getElementById('tc_plazo').value)||0;
        if(P<=0||n<=0) return;
        let tem=Math.pow(1+(tea/100), 1/12)-1; document.getElementById('tc_tem').value=(tem*100).toFixed(2);
        let cuota=P*(tem*Math.pow(1+tem,n))/(Math.pow(1+tem,n)-1); appData.tc_cuota=cuota;
        let tbody=document.getElementById('tc_tabla_body'); tbody.innerHTML=''; let saldo=P, fecha=new Date();
        for(let i=1; i<=n; i++) { fecha.setMonth(fecha.getMonth()+1); let int=saldo*tem, amort=cuota-int; saldo-=amort; tbody.innerHTML+=`<tr><td>${i}</td><td>-</td><td>${fecha.toLocaleDateString()}</td><td>30</td><td>${(saldo+amort).toFixed(2)}</td><td>${amort.toFixed(2)}</td><td>${int.toFixed(2)}</td><td>${cuota.toFixed(2)}</td></tr>`; }
    }

    function calcSeguroPPD() {
        let sol=appData.total; let seg=sol*0.0079*12; // Aprox
        document.getElementById('ppd_importe_sol').value=sol.toFixed(2); document.getElementById('ppd_costo_seguro').innerText=seg.toFixed(2); document.getElementById('ppd_importe_fin').innerText=(sol+seg).toFixed(2); appData.ppd_seguro=seg;
    }

    function calcPPD() {
        let P=appData.total+appData.ppd_seguro; document.getElementById('ppd_c_sol').value=appData.total.toFixed(2); document.getElementById('ppd_abonar').innerText=appData.total.toFixed(2); document.getElementById('ppd_financiar').innerText=P.toFixed(2);
        let tea=parseFloat(document.getElementById('ppd_tea').value)||0, n=parseInt(document.getElementById('ppd_plazo').value)||0;
        let tem=Math.pow(1+(tea/100), 1/12)-1; let cuota=P*(tem*Math.pow(1+tem,n))/(Math.pow(1+tem,n)-1); document.getElementById('ppd_cuota_res').value=cuota.toFixed(2); appData.ppd_total=P; appData.ppd_cuota=cuota;
        let tbody=document.getElementById('ppd_tabla_crono'); tbody.innerHTML=''; let saldo=P, fecha=new Date();
        for(let i=1; i<=n; i++) { fecha.setMonth(fecha.getMonth()+1); let int=saldo*tem, amort=cuota-int; saldo-=amort; tbody.innerHTML+=`<tr><td>${i}</td><td style="background:#ffffcc; color:black">${fecha.toLocaleDateString()}</td><td>${saldo.toFixed(2)}</td><td>${cuota.toFixed(2)}</td></tr>`; }
    }

    function sincronizar() {
        document.getElementById('tc_saldo_crm').innerText=appData.total.toFixed(2);
        if(document.getElementById('screen-Calculo_TC').classList.contains('active')) calcularCronograma();
        if(document.getElementById('screen-Calculo_Seguro').classList.contains('active')) calcSeguroPPD();
        if(document.getElementById('screen-Calculo_PPD').classList.contains('active')) calcPPD();
        
        document.getElementById('sp_monto').value = "S/ " + appData.total.toFixed(2);
        document.getElementById('sp_cuota_ppd').value = "S/ " + appData.tc_cuota.toFixed(2);
        document.getElementById('camp_abono_s').innerText = document.getElementById('sp_ini_s').value || "S/ 0.00";

        document.getElementById('sp_ppd_monto').value = "S/ " + appData.ppd_total.toFixed(2);
        document.getElementById('sp_ppd_seguro_val').value = "S/ " + appData.ppd_seguro.toFixed(2);
        document.getElementById('sp_ppd_cuota').value = "S/ " + appData.ppd_cuota.toFixed(2);
    }

    function actualizarValidacion(tipo) {
        let name = (tipo==='TC') ? document.getElementById('sp_nombre').value : document.getElementById('sp_ppd_nombre').value;
        if(tipo==='TC') document.getElementById('val_nombre').innerText = name;
    }

    function generarSpeechTC() {
        let nom=document.getElementById('sp_nombre').value;
        document.getElementById('txt_saludo').innerHTML=`<p>Buenos días, me comunico con el Sr./Srta. <span class="hl">${nom}</span>...</p>`;
        document.getElementById('txt_resumen').innerHTML=`<p>La deuda registrada es de <span class="hl">S/ ${appData.total.toFixed(2)}</span>...</p>`;
    }

    function generarSpeechPPD() {
        document.getElementById('res_ppd_monto').innerText = "S/ " + appData.ppd_total.toFixed(2);
        document.getElementById('res_ppd_abonar').innerText = "S/ " + appData.total.toFixed(2);
        document.getElementById('res_ppd_costo_seg').innerText = "S/ " + appData.ppd_seguro.toFixed(2);
        document.getElementById('res_ppd_cuota_val').innerText = "S/ " + appData.ppd_cuota.toFixed(2);
    }

    function limpiarSpeech() {
        document.getElementById('sp_nombre').value=''; document.getElementById('sp_dni').value='';
    }
</script>
</body>
</html>